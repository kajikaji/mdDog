[% INCLUDE header.tmpl %]
[% INCLUDE apptitle.tmpl %]
[% INCLUDE userinfo.tmpl %]

<ul class="back-nav">
<li><a href="index.cgi">ファイル一覧に戻る</a></li> 
<li><a href="docinfo.cgi?fid=[% fid %]">ファイル履歴に戻る</a></li>
<li><a href="md_view.cgi?fid=[% fid %]">閲覧に戻る</a></li>
</ul>

<section class="docinfo">
<h1>ドキュメント編集</h1>
<h2>[% file_name %]<span class="supplement">--&ensp;editing&ensp;--</span></h2>
<div class="description">
  <div class="created-at">作成日時：</div>
  <div class="created-by">作成者：</div>
  <div class="last-approved-at">最終承認日時：</div>
  <div class="filesize">ファイルサイズ：</div>
</div>

</section> <!-- docinfo -->

<section class="md_buffer">
  [% SWITCH style %]
  [% CASE "source" %]
  <form class="md-editor" action="?fid=[% fid %]" method="post">
    <div class="md-buffer-fix">
      <input type="submit" name="commit" value="バッファをコミット">
      コメント：<input type="text" name="comment" size="30">
      <input type="hidden" name="fid" value="[% fid %]">  
    </div>

    <ul class="md_menu">
      <li class="active">ソース</li>
      <li><a href="?fid=[% fid %]&style=preview">プレビュー</a></li>
    </ul>

    <div class="canvas"><textarea rows="20" name="document">[% document %]</textarea></div>
    <div class="ctrl">
      <input type="submit" name="update" value="一時保存">
      <input type="hidden" name="fid" value="[% fid %]">  
    </div>
  </form>
  [% CASE "preview" %]
  <form class="md-buffer-fix" action="?id=fid=[% fid %]" method="post">
    <input type="submit" name="commit" value="バッファをコミット">
    コメント：<input type="text" name="comment" size="30">
    <input type="hidden" name="fid" value="[% fid %]">  
    <textarea name="document" class="rowdata" style="display: none;">[% document %]</textarea>
    <div class="rowdata" style="display: none;">[% rowdata %]</div>
  </form>
  <ul class="md_menu">
    <li><a href="?fid=[% fid %]&style=source">ソース</a></li>
    <li class="active">プレビュー</li>
  </ul>
  <div class="document">
    [% markdown %]
  </div>
  [% END %]
</section>

</body>
</html>
